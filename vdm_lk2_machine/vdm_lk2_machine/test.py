import os
import json
from openpyxl import Workbook

producePlan_path = os.path.join(os.path.expanduser("~"),
                                'ros2_ws/src/vdm_machiner/vdm_lk2_machine/database/form_khsx_cdth.xlsx')

# Chuỗi JSON
json_string = '[["KẾ HOẠCH SẢN XUẤT CÔNG ĐOẠN THÀNH HÌNH",null,null,null,null,null,null,null,"SPM thực thế",null,null,null,null,null,"Mã hàng",null,null,null,null,null],["Máy","Ca","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7"],["J01","D",38160,38160,38160,38160,38160,38160,53.0061349693252,53.0061349693252,53.0061349693252,53.0061349693252,53.0061349693252,53.0061349693252,"04148XA","04148XA","04148XA","04148XA","04148XA","04148XA"],["J01","N",38160,38160,38160,38160,38160,30240,53.0061349693252,53.0061349693252,53.0061349693252,53.0061349693252,53.0061349693252,53.0061349693252,"04148XA","04148XA","04148XA","04148XA","04148XA","04148XA"],["J02","D",293988,293988,236072,293988,0,0,408.317580340265,408.317580340265,408.317580340265,408.317580340265,0,0,"15E09XB","15E09XB","15E09XB","15E09XB",null,null],["J02","N",293988,293988,293988,0,0,0,408.317580340265,408.317580340265,408.317580340265,0,0,0,"15E09XB","15E09XB","15E09XB",null,null,null],["J03","D",12084,0,0,0,0,0,15.0313152400835,0,0,0,0,0,"49551XA",null,null,null,null,null],["J03","N",7916,0,0,0,0,0,15.0313152400835,0,0,0,0,0,"49551XA",null,null,null,null,null],["J04","D",4903,4903,4903,582,4903,4903,7.5,7.5,7.5,7.5,8.05068952664927,8.05068952664927,"32BQPXB","32BQPXB","32BQPXB","32BQPXB","32BQNXB","32BQNXB"],["J04","N",4903,4903,4903,388,4903,4903,7.5,7.5,7.5,8.05068952664927,8.05068952664927,8.05068952664927,"32BQPXB","32BQPXB","32BQPXB","32BQNXB","32BQNXB","32BQNXB"],["J05","D",42404,42404,42404,42404,5768,0,57.9865771812081,57.9865771812081,57.9865771812081,57.9865771812081,57.9865771812081,0,"32BKVXB","32BKVXB","32BKVXB","32BKVXB","32BKVXB",null],["J05","N",42404,42404,42404,42404,0,0,57.9865771812081,57.9865771812081,57.9865771812081,57.9865771812081,0,0,"32BKVXB","32BKVXB","32BKVXB","32BKVXB",null,null],["J06","D",0,0,19550,19550,19550,19550,0,0,27.1527341294783,27.1527341294783,27.1527341294783,27.1527341294783,null,null,"32BRHXA","32BRHXA","32BRHXA","32BRHXA"],["J06","N",0,18600,19550,19550,19550,19550,0,27.1527341294783,27.1527341294783,27.1527341294783,27.1527341294783,27.1527341294783,null,"32BRHXA","32BRHXA","32BRHXA","32BRHXA","32BRHXA"],["J07","D",0,0,0,0,0,0,0,0,0,0,0,0,null,null,null,null,null,null],["J07","N",0,0,0,0,0,0,0,0,0,0,0,0,null,null,null,null,null,null],["J08","D",67034,45000,71256,71256,71256,71256,93.1034482758621,95.2590959206174,98.9690721649485,98.9690721649485,98.9690721649485,98.9690721649485,"32C99XA","32BLBXA","31788AB","31788AB","31788AB","31788AB"],["J08","N",22966,71208,71256,71256,71256,0,93.1034482758621,98.9690721649485,98.9690721649485,98.9690721649485,98.9690721649485,0,"32C99XA","31788AB","31788AB","31788AB","31788AB",null],["J09","D",35615,35615,35615,35615,35615,35615,49.4656488549618,49.4656488549618,49.4656488549618,49.4656488549618,49.4656488549618,49.4656488549618,"32BQ7XA","32BQ7XA","32BQ7XA","32BQ7XA","32BQ7XA","32BQ7XA"],["J09","N",34625,35615,35615,35615,35615,35615,49.4656488549618,49.4656488549618,49.4656488549618,49.4656488549618,49.4656488549618,49.4656488549618,"32BQ7XA","32BQ7XA","32BQ7XA","32BQ7XA","32BQ7XA","32BQ7XA"],["J10","D",34560,34560,34560,34560,35615,35615,55.6701030927835,55.6701030927835,55.6701030927835,55.6701030927835,49.4656488549618,49.4656488549618,"32BPVXA","32BPVXA","32BPVXA","32BPVXA","32BQ7XA","32BQ7XA"],["J10","N",30000,34560,34560,35150,35615,35615,55.6701030927835,55.6701030927835,55.6701030927835,49.4656488549618,49.4656488549618,49.4656488549618,"32BPVXA","32BPVXA","32BPVXA","32BQ7XA","32BQ7XA","32BQ7XA"],["J11","D",62832,62832,62832,62832,62832,62832,87.2727272727273,87.2727272727273,87.2727272727273,87.2727272727273,87.2727272727273,87.2727272727273,"14332AA","14332AA","14332AA","14332AA","14332AA","14332AA"],["J11","N",62832,62832,62832,62832,62832,62832,87.2727272727273,87.2727272727273,87.2727272727273,87.2727272727273,87.2727272727273,87.2727272727273,"14332AA","14332AA","14332AA","14332AA","14332AA","14332AA"],["J12","D",46016,0,16548,16548,16548,712,87.2727272727273,0,22.9787234042553,22.9787234042553,22.9787234042553,22.9787234042553,"14332AA",null,"43G88XA","43G88XA","43G88XA","43G88XA"],["J12","N",0,0,16548,16548,16548,0,0,0,22.9787234042553,22.9787234042553,22.9787234042553,0,null,null,"43G88XA","43G88XA","43G88XA",null],["J13","D",74000,74000,74000,74000,70000,74000,102.857142857143,102.857142857143,102.857142857143,102.857142857143,102.857142857143,102.857142857143,"31873AA","31873AA","31873AA","31873AA","31873AA","31873AA"],["J13","N",74000,74000,74000,74000,74000,74000,102.857142857143,102.857142857143,102.857142857143,102.857142857143,102.857142857143,102.857142857143,"31873AA","31873AA","31873AA","31873AA","31873AA","31873AA"],["J14","D",62899,40000,69744,69744,34872,52896,87.360970677452,86.4864864864865,108.40652446675,108.40652446675,108.40652446675,73.469387755102,"32Y28XA","32R29XA","32R28XA","32R28XA","32R28XA","43D28XA"],["J14","N",7101,16152,69744,69744,52896,18208,87.360970677452,108.40652446675,108.40652446675,108.40652446675,73.469387755102,73.469387755102,"32Y28XA","32R28XA","32R28XA","32R28XA","43D28XA","43D28XA"],["J15","D",65340,65340,65688,65688,65688,65340,90.7563025210084,90.7563025210084,91.2354804646251,91.2354804646251,91.2354804646251,90.7563025210084,"32BSGXA","32BSGXA","32R37XA","32R37XA","32R37XA","32BSGXA"],["J15","N",65340,65688,65688,65688,49172,65340,90.7563025210084,91.2354804646251,91.2354804646251,91.2354804646251,91.2354804646251,90.7563025210084,"32BSGXA","32R37XA","32R37XA","32R37XA","32R37XA","32BSGXA"],["J16","D",15000,6752,41472,41472,41472,41472,32.8267477203647,30.6382978723404,30.6382978723404,30.6382978723404,30.6382978723404,30.6382978723404,"32BS6XA","32BQ9XC","32BQ9XC","32BQ9XC","32BQ9XC","32BQ9XC"],["J16","N",15000,41472,41472,41472,41472,41472,32.8267477203647,30.6382978723404,30.6382978723404,30.6382978723404,30.6382978723404,30.6382978723404,"32BS6XA","32BQ9XC","32BQ9XC","32BQ9XC","32BQ9XC","32BQ9XC"],["J17","D",42024,0,0,0,0,0,58.3783783783784,0,0,0,0,0,"32BL3XA",null,null,null,null,null],["J17","N",7976,0,0,0,0,0,58.3783783783784,0,0,0,0,0,"32BL3XA",null,null,null,null,null],["J18","D",79044,79044,79044,79044,79044,79044,110.063694267516,110.063694267516,110.063694267516,110.063694267516,110.063694267516,110.063694267516,"32BS3XA","32BS3XA","32BS3XA","32BS3XA","32BS3XA","32BS3XA"],["J18","N",79044,79044,79044,77068,79044,79044,110.063694267516,110.063694267516,110.063694267516,110.063694267516,110.063694267516,110.063694267516,"32BS3XA","32BS3XA","32BS3XA","32BS3XA","32BS3XA","32BS3XA"],["J19","D",75864,75864,75864,75864,75864,42000,105.365853658537,105.365853658537,105.365853658537,105.365853658537,105.365853658537,102.857142857143,"31757AA","31757AA","31757AA","31757AA","31757AA","31873AA"],["J19","N",75864,75864,75864,75864,17224,74000,105.365853658537,105.365853658537,105.365853658537,105.365853658537,105.365853658537,102.857142857143,"31757AA","31757AA","31757AA","31757AA","31757AA","31873AA"],["J20","D",278124,278124,278124,131256,0,12156,386.28912071535,386.28912071535,386.28912071535,386.28912071535,0,16.875,"15B24XB","15B24XB","15B24XB","15B24XB",null,"04171XA"],["J20","N",278124,278124,278124,0,0,11972,386.28912071535,386.28912071535,386.28912071535,0,0,16.875,"15B24XB","15B24XB","15B24XB",null,null,"04171XA"],["J21","D",12156,12156,12156,12156,12156,12156,16.875,16.875,16.875,16.875,16.875,16.875,"04171XA","04171XA","04171XA","04171XA","04171XA","04171XA"],["J21","N",12156,12156,12156,12156,12156,12156,16.875,16.875,16.875,16.875,16.875,16.875,"04171XA","04171XA","04171XA","04171XA","04171XA","04171XA"],["J22","D",4690,5531,5531,5531,5531,5531,7.68136557610242,7.68136557610242,7.68136557610242,7.68136557610242,7.68136557610242,7.68136557610242,"22D70XA","22D70XA","22D70XA","22D70XA","22D70XA","22D70XA"],["J22","N",5531,5531,5531,0,5531,5531,7.68136557610242,7.68136557610242,7.68136557610242,0,7.68136557610242,7.68136557610242,"22D70XA","22D70XA","22D70XA",null,"22D70XA","22D70XA"],["J23","D",0,0,0,0,0,0,0,0,0,0,0,0,null,null,null,null,null,null],["J23","N",0,0,0,0,0,0,0,0,0,0,0,0,null,null,null,null,null,null],["J24","D",7353,7353,7353,7353,7353,6470,10.2127659574468,10.2127659574468,10.2127659574468,10.2127659574468,10.2127659574468,10.2127659574468,"31865AA","31865AA","31865AA","31865AA","31865AA","31865AA"],["J24","N",7353,7353,7353,7353,7353,20000,10.2127659574468,10.2127659574468,10.2127659574468,10.2127659574468,10.2127659574468,26.6666666666667,"31865AA","31865AA","31865AA","31865AA","31865AA","32BRZXB"]]'
# Chuyển chuỗi JSON thành đối tượng Python
data = json.loads(json_string)

wb = Workbook()
ws = wb.active

for row_data in data:
    ws.append(row_data)

wb.save(producePlan_path)
wb.close()


